version: 2

unit_tests:
  - name: interview_duration_calculated_correctly
    model: fct_interview

    given:
      - input: ref('stg_interview')
        rows:
          - id: 1
            status: IN_PROGRESS
            updated_at: '2024-12-17T14:05:01'
          - id: 1
            status: PENDING_FEEDBACK
            updated_at: '2024-12-17T15:30:00'

      - input: ref('latest_interview')
        rows:
          - id: 1
            run_type: ONLINE
            status: IN_PROGRESS
            created_at: '2024-12-17T14:00:00'
            candidate_id: 10
            interviewer_id: 20

      - input: ref('stg_candidate')
        rows: []

      - input: ref('stg_employee')
        rows: []

    expect:
      rows:
        - interview_duration_minutes: 85
